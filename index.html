<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>네모네모 서울 식물원</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/studio-freight/lenis@1.0.29/bundled/lenis.min.js"></script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            overflow-x: hidden; 
            background-color: #f0f0f0; 
            overflow: hidden; 
        }

        img { -webkit-user-drag: none; backface-visibility: hidden; -webkit-backface-visibility: hidden; }

        /* [1] 초기 로딩 */
        #preloader {
            position: fixed; top: 0; left: 0;
            width: 100%; height: 100vh;
            background-color: #e8f5e9; 
            z-index: 9999; 
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            will-change: opacity; 
        }
        .loader-text { font-family: 'Noto Sans KR', sans-serif; font-size: 1.2rem; color: #2e7d32; margin-bottom: 20px; font-weight: bold; }
        .loader-percent { font-size: 4rem; font-weight: 900; color: #1b5e20; }
        .loader-bar-bg { width: 300px; height: 4px; background: #c8e6c9; margin-top: 20px; border-radius: 2px; overflow: hidden; }
        .loader-bar { width: 0%; height: 100%; background: #43a047; }

        /* [NEW] 안내 패널 */
        #scroll-guide {
            position: fixed; top: 0; left: 0;
            width: 100%; height: 100vh;
            z-index: 9000; 
            display: flex; justify-content: center; align-items: center;
            pointer-events: none; 
            opacity: 0; visibility: hidden; 
        }
        .guide-box {
            background-color: rgba(0, 0, 0, 0.4); 
            padding: 15px 30px;
            border-radius: 50px;
            backdrop-filter: blur(5px); 
            animation: blink 2s infinite ease-in-out; 
        }
        .guide-text { color: #fff; font-family: 'Noto Sans KR', sans-serif; font-size: 1.1rem; font-weight: 500; letter-spacing: 1px; }
        @keyframes blink {
            0% { opacity: 0.4; transform: translateY(0); }
            50% { opacity: 1; transform: translateY(-5px); } 
            100% { opacity: 0.4; transform: translateY(0); }
        }

        /* [2] 중간 로딩 */
        #interim-loader {
            position: fixed; top: 0; left: 0;
            width: 100%; height: 100vh;
            background-color: #fff; 
            z-index: 8000; 
            opacity: 0; visibility: hidden; 
            pointer-events: none; 
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
        }
        .interim-text {
            font-family: 'Noto Sans KR', serif; 
            font-size: 1.5rem; color: #1b5e20;
            letter-spacing: 5px;
            animation: pulse 2s infinite;
        }
        @keyframes pulse { 0% { opacity: 0.5; } 50% { opacity: 1; } 100% { opacity: 0.5; } }

        /* [Section 1] */
        #global-background {
            position: fixed; top: 0; left: 0; width: 140vw; height: 100vh;
            z-index: 0; 
            background-image: url('./images/section1_bg.webp'); 
            background-size: cover; background-position: left center; 
            , opacity, filter; 
            -webkit-backface-visibility: hidden; backface-visibility: hidden; transform: translate3d(0, 0, 0);
        }
        #section1 { position: relative; width: 100%; height: 100vh; overflow: hidden; z-index: 10; background-color: transparent; will-change: opacity, filter; }
        .layer { position: absolute; background-repeat: no-repeat;  transform: translate3d(0, 0, 0); }

        .island-main { width: 75%; height: auto; aspect-ratio: 16/9; left: -0%; bottom: -10%; background-size: cover; background-position: left bottom; background-image: url('./images/section1_mainblock.webp'); z-index: 4; }
        .greenhouse-far { width: 65%; height: auto; aspect-ratio: 16/9; right: 0%; top: 0%; background-size: cover; background-position: right top; background-image: url('./images/section1_farplanet.webp'); z-index: 3; }
        .water-cube { width: 120%; height: auto; aspect-ratio: 1/1; right: 0%; top: 0%; background-size: contain; background-image: url('./images/section1_waterblock.webp'); z-index: 5; }
        .island-small { width: 100%; height: auto; aspect-ratio: 4/3; left: 4%; top: 20%; background-size: contain; background-image: url('./images/section1_mainclose.webp'); z-index: 2; }
        .cloud-far-1 { width: 100%; height: auto; aspect-ratio: 3/2; left: 5%; top: 5%; background-size: contain; background-image: url('./images/section1_farcloud1.webp'); z-index: 1; }
        .cloud-far-2 { width: 100%; height: auto; aspect-ratio: 3/2; right: 35%; top: 10%; background-size: contain; background-image: url('./images/section1_farcloud2.webp'); z-index: 1; }
        .block-close { width: 100%; height: auto; aspect-ratio: 1/1; right: 0%; bottom: 5%; background-size: contain; background-image: url('./images/section1_closeblock.webp'); z-index: 7; }
        .cloud-close { width: 100%; height: auto; aspect-ratio: 2/1; left: -5%; bottom: 25%; background-size: contain; background-image: url('./images/section1_closecloud.webp'); z-index: 6; }
        .deco { position: absolute; background-size: contain; background-repeat: no-repeat; background-position: center; transform: translate3d(0, 0, 0); }
        .bush { width: 50%; height: 50%; top: 0%; left: 23%; background-image: url('./images/section1_bush.webp'); z-index: 5; }
        .water-float { width: 100%; height: 100%; top: -32%; right: 0%; background-image: url('./images/section1_waterblockfloat.webp'); z-index: 6; }
        .water-cloud { width: 20%; height: 50%; top: -10%; right: -10%; background-image: url('./images/section1_closecloud2.webp'); z-index: 7; opacity: 0.9; }
        .water-cloud2 { width: 30%; height:30%; top: 28%; right:5%; background-image: url('./images/section1_closecloud2.webp'); z-index: 1; opacity: 0.9; }

        /* [Section 2] */
        #section2 { 
            position: relative; width: 100%; height: 100vh;
            background-color: #7ccad4; 
            overflow: hidden; 
            opacity: 0; visibility: hidden; 
            display: flex; justify-content: flex-start; align-items: flex-start;
            z-index: 50; 
        }

        .h-scroll-track { display: flex; height: 100%; width: fit-content; margin: 0; padding: 0; position: relative; }
        
        .h-bg-image, .tree-img, .ground-img, .grass-img, .rock-img, .palm-img, .hanok-img, .woodpad-img, .giwa-img {
            height: 100vh; width: auto; max-width: none; display: block; flex-shrink: 0; object-fit: cover; transform: translate3d(0, 0, 0);
        }

        .h-center-layer { position: absolute; top: 0; left: 50%; transform: translateX(-50%); width: auto; height: 100%; pointer-events: none; z-index: 2; }
        .hanok-img { height: auto; width: 110vw; margin-top: 10vh; }
        .h-midground-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 3; }
        .tree-img { transform-origin: bottom center; }
        .h-ground-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 4; }
        .h-foreground-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 5; }
        .grass-img { transform-origin: bottom center; }
        
        .h-step-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 7; }
        .h-giwa-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 7; }
        .giwa-wrapper { position: absolute; width: 100%; height: 100%; top: 0; left: 0; }
        .woodpad-img, .giwa-img { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; }

        .h-static-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 6; }
        .h-palm-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 8; }
        .palm-left { position: absolute; left: 0; bottom: 0; transform-origin: left center; }
        .palm-right { position: absolute; right: 0; top: 0; transform-origin: right top; }
        .h-content-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; }

        .h-step-layer .woodpad-img:nth-child(1) { left: 0%; bottom: 0%; }
        .h-step-layer .woodpad-img:nth-child(2) { left: 3%; bottom: 2%; }
        .h-step-layer .woodpad-img:nth-child(3) { left: 6%; bottom: 4%; }

        .h-giwa-layer .giwa-wrapper:nth-child(1) { left: 9%; bottom: 2%; }
        .h-giwa-layer .giwa-wrapper:nth-child(2) { left: 12%; bottom: 5%; }
        .h-giwa-layer .giwa-wrapper:nth-child(3) { left: 15%; bottom: 3%; }


        /* [Section 3] 세로 스크롤 스타일 */
        #section3 {
            position: relative;
            width: 100%;
            height: 100vh;
            overflow: hidden;
            background-color: #fff; 
            z-index: 60; 
        }

        .v-scroll-track {
            width: 100%;
            height: 100%;
            position: relative;
            display: flex;
            justify-content: center;
        }

        .v-bg-image {
            width: 100%;
            height: auto; 
            min-height: 120vh; 
            display: block;
            object-fit: cover;
            position: absolute;
            bottom: 0; 
           ;
        }

        .v-objects {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: none;
            z-index: 2; 
        }

        /* 블록 스타일 (사용자 지정 값 유지) */
        .block-1f {
            position: absolute;
            right: 0%; 
            bottom: 0%; 
            width: 100vw; 
            height: auto;
            transform-origin: center bottom;
        }

        .block-2f {
            position: absolute;
            right: 0%; 
            bottom: 0%; 
            width: 100vw; 
            height: auto;
            transform-origin: center bottom;
            z-index: 3; 
        }

        .block-3f {
            position: absolute;
            left: 0%; 
            bottom: 0%; 
            width: 100vw; 
            height: auto;
            transform-origin: center bottom;
            z-index: 4; 
        }

    </style>
</head>
<body>

    <div id="preloader">
        <div class="loader-text">서울 식물원 여행 준비 중...</div>
        <div class="loader-percent">0%</div>
        <div class="loader-bar-bg">
            <div class="loader-bar"></div>
        </div>
    </div>

    <div id="scroll-guide">
        <div class="guide-box">
            <span class="guide-text">마우스를 천천히 스크롤해보세요!</span>
        </div>
    </div>

    <div id="interim-loader">
        <div class="interim-text">한국 정원 로딩중...<br>계속 스크롤 해주세요!</div>
    </div>

    <div id="global-background"></div>

    <div id="wrapper">
        <section id="section1">
            <div class="layer cloud-far-1"></div>
            <div class="layer cloud-far-2"></div>
            <div class="layer greenhouse-far"></div> 
            <div class="layer island-main">
                <div class="deco bush"></div>
            </div>
            <div class="layer island-small"></div>
            <div class="layer water-cube">
                <div class="deco water-float"></div>
                <div class="deco water-cloud"></div> 
                 <div class="deco water-cloud2"></div> 
            </div>
            <div class="layer cloud-close"></div>
            <div class="layer block-close"></div>
        </section>
    </div>

    <section id="section2" class="next-section">
        <div class="h-scroll-track">
            <img src="./images/section2_bg.jpg" class="h-bg-image" alt="Background" loading="eager" decoding="async">
            <div class="h-center-layer"><img src="./images/section2_hanok.webp" class="hanok-img" alt="Hanok" loading="eager" decoding="async"></div>
            <div class="h-midground-layer"><img src="./images/section2_tree.webp" class="tree-img" alt="Pine Trees" loading="eager" decoding="async"></div>
            <div class="h-ground-layer"><img src="./images/section2_grassground.webp" class="ground-img" alt="Ground Mask" loading="eager" decoding="async"></div>
            <div class="h-foreground-layer"><img src="./images/section2_grass.webp" class="grass-img" alt="Grass" loading="eager" decoding="async"></div>
            <div class="h-step-layer">
                <img src="./images/section2_woodpad1.webp" class="woodpad-img" alt="Wood Step 1" loading="eager" decoding="async">
                <img src="./images/section2_woodpad2.webp" class="woodpad-img" alt="Wood Step 2" loading="eager" decoding="async">
                <img src="./images/section2_woodpad3.webp" class="woodpad-img" alt="Wood Step 3" loading="eager" decoding="async">
            </div>
            <div class="h-giwa-layer">
                <div class="giwa-wrapper">
                    <img src="./images/section2_giwa1.webp" class="giwa-img" alt="Giwa Step 1" loading="eager" decoding="async">
                </div>
                <div class="giwa-wrapper">
                    <img src="./images/section2_giwa2.webp" class="giwa-img" alt="Giwa Step 2" loading="eager" decoding="async">
                </div>
                <div class="giwa-wrapper">
                    <img src="./images/section2_giwa3.webp" class="giwa-img" alt="Giwa Step 3" loading="eager" decoding="async">
                </div>
            </div>
            <div class="h-static-layer"><img src="./images/section2_rock.webp" class="rock-img" alt="Static Rocks" loading="eager" decoding="async"></div>
            <div class="h-palm-layer">
                <img src="./images/section2_palmleft.webp" class="palm-img palm-left" alt="Palm Left" loading="eager" decoding="async">
                <img src="./images/section2_palmright.webp" class="palm-img palm-right" alt="Palm Right" loading="eager" decoding="async">
            </div>
            <div class="h-content-layer"></div>
        </div>
    </section>

    <section id="section3">
        <div class="v-scroll-track">
            <img src="./images/section3_bg.jpg" class="v-bg-image" alt="Vertical Scroll Background" loading="eager" decoding="async">
            
            <div class="v-objects">
                <img src="./images/section3_1f.webp" class="block-1f" alt="1st Floor" loading="eager" decoding="async">
                <img src="./images/section3_2f.webp" class="block-2f" alt="2nd Floor" loading="eager" decoding="async">
                <img src="./images/section3_3f.webp" class="block-3f" alt="3rd Floor" loading="eager" decoding="async">
            </div>
        </div>
    </section>

   <script>
        const lenis = new Lenis({
            duration: 1.2, easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)), direction: 'vertical', gestureDirection: 'vertical', smooth: true, mouseMultiplier: 1, smoothTouch: false, touchMultiplier: 2,
        });
        lenis.on('scroll', ScrollTrigger.update);
        gsap.ticker.add((time) => { lenis.raf(time * 1000); });
        gsap.ticker.lagSmoothing(0);

        gsap.registerPlugin(ScrollTrigger);

        let loadedCount = { val: 0 };
        gsap.to(loadedCount, {
            val: 100, duration: 2, ease: "power1.inOut",
            onUpdate: function() {
                document.querySelector(".loader-percent").innerText = Math.floor(loadedCount.val) + "%";
                document.querySelector(".loader-bar").style.width = Math.floor(loadedCount.val) + "%";
            },
            onComplete: function() { checkLoadAndStart(); }
        });

        let isWindowLoaded = false;
        window.addEventListener("load", () => {
            isWindowLoaded = true;
            checkLoadAndStart();
        });

        function checkLoadAndStart() {
            if (loadedCount.val >= 100 && isWindowLoaded) {
                gsap.to("#preloader", {
                    autoAlpha: 0, duration: 1,
                    onComplete: () => {
                        gsap.to("#scroll-guide", { autoAlpha: 1, duration: 1 });
                        document.body.style.overflow = "auto";
                        document.body.style.overflowX = "hidden"; 
                        ScrollTrigger.refresh();
                    }
                });
            }
        }

        ScrollTrigger.create({
            start: 5, once: true,
            onEnter: () => { gsap.to("#scroll-guide", { autoAlpha: 0, duration: 0.5 }); }
        });

        const tl = gsap.timeline({
            scrollTrigger: {
                trigger: "#wrapper",
                start: "top top",
                end: "+=1500%", 
                pin: true, scrub: 1, anticipatePin: 1, 
            }
        });

        tl.addLabel("start");

        tl.from(".island-main", { xPercent: -40, yPercent: 20, autoAlpha: 0, duration: 6, ease: "power2.out" }, "start")
          .from(".greenhouse-far", { xPercent: 40, yPercent: -20, scale: 0.6, autoAlpha: 0, duration: 6, ease: "power2.out" }, "start+=0.5")
          .from(".island-small", { yPercent: -100, autoAlpha: 0, duration: 5 }, "start+=1")
          .from(".water-cube", { xPercent: 50, yPercent: 50, rotation: 10, duration: 5.5 }, "start+=1.5")
          .from(".block-close", { xPercent: 50, duration: 4 }, "start+=2")
          .from(".cloud-close", { xPercent: -200, autoAlpha: 0, duration: 5, ease: "power1.out"}, "start+=2")
          .from(".cloud-far-1", { xPercent: -200, autoAlpha: 0, duration: 5, ease: "power1.out"}, "start+=2")
          .from(".cloud-far-2", { yPercent: -50, autoAlpha: 0, duration: 4 }, "start+=2");

        tl.to("#section1", { scale: 2, xPercent: 25, yPercent: -25, duration: 10, ease: "power2.inOut" }, "+=1") 
          .to("#global-background", { scale: 1.1, xPercent: 5, duration: 10 }, "<")
          .to(".cloud-close", { xPercent: 20, yPercent: 30, duration: 10, ease: "power2.inOut" }, "<")
          .to(".cloud-far-1", { xPercent: 30, yPercent: 0, duration: 10, ease: "power2.inOut" }, "<");

        tl.to("#section1", { scale: 2.2, xPercent: -45, yPercent: 10, duration: 7, ease: "power2.inOut" })
          .to("#global-background", { xPercent: -5, duration: 7 }, "<")
          .to(".cloud-close", { xPercent: -10, yPercent: 0, duration: 7, ease: "power2.inOut" }, "<")
          .to(".cloud-far-1", { xPercent: -10, yPercent: 0, duration: 7, ease: "power2.inOut" }, "<");

        tl.to("#section1", { scale: 5, xPercent: -200, yPercent: 200, duration: 15, ease: "power2.in" })
          .to("#global-background", { scale: 1.3, duration: 15 }, "<");

        // 트랜지션
        tl.to("#interim-loader", { autoAlpha: 1, backgroundColor: "#ffffff", duration: 3 })
          .to("#section1, #global-background", { filter: "blur(15px)", autoAlpha: 0, duration: 3 }, "<");

        tl.to({}, { duration: 1 });

        tl.to("#interim-loader", { backgroundColor: "#7ccad4", duration: 3 });
        tl.to(".interim-text", { autoAlpha: 0, duration: 1 });
        tl.set("#section2", { autoAlpha: 1 });
        tl.to("#interim-loader", { autoAlpha: 0, duration: 4 });


        gsap.to(".island-main", { y: 15, rotation: 1, duration: 4, yoyo: true, repeat: -1, ease: "sine.inOut" });
        gsap.to(".greenhouse-far", { y: 20, rotation: -1, duration: 5, delay: 1, yoyo: true, repeat: -1, ease: "sine.inOut" });
        gsap.to(".island-small", { y: -80, duration: 3, delay: 1, yoyo: true, repeat: -1, ease: "sine.inOut" });
        gsap.to(".water-cube", { y: 15, rotation: 3, duration: 3, delay: 0.5, yoyo: true, repeat: -1, ease: "sine.inOut" });
        gsap.to(".block-close", { y: 8, duration: 2.5, yoyo: true, repeat: -1, ease: "sine.inOut" });
        gsap.to(".cloud-far-1", { x: 20, y: 5, duration: 6, yoyo: true, repeat: -1, ease: "sine.inOut" });
        gsap.to(".cloud-far-2", { x: -20, y: 5, duration: 7, delay: 1, yoyo: true, repeat: -1, ease: "sine.inOut" });
        gsap.to(".cloud-close", { x: 15, y: -5, duration: 5.5, delay: 2, yoyo: true, repeat: -1, ease: "sine.inOut" });
        gsap.to(".water-float", { y: -10, rotation: 3, duration: 2.5, yoyo: true, repeat: -1, ease: "sine.inOut" });
        gsap.to(".bush", { rotation: 5, scaleY: 0.9, transformOrigin: "bottom center", duration: 1.2, ease: "elastic.out(1.2, 0.4)", yoyo: true, repeat: -1 });
        gsap.to(".water-cloud", { x: 10, y: -10, duration: 4, delay: 1, yoyo: true, repeat: -1, ease: "sine.inOut" });
        gsap.to(".water-cloud2", { x: 15, y: -1, duration: 2, delay: 2, yoyo: true, repeat: -1, ease: "sine.inOut" });


        // [SECTION 2] 로직
        window.addEventListener("load", () => {
            const section2 = document.querySelector("#section2");
            const track = document.querySelector(".h-scroll-track");
            const image = document.querySelector(".h-bg-image");

            const section3 = document.querySelector("#section3");
            const vImage = document.querySelector(".v-bg-image");

            if(!track || !image || !vImage) return;

            function getScrollAmount() {
                let imageWidth = image.offsetWidth; 
                let windowWidth = window.innerWidth; 
                return -(imageWidth - windowWidth);
            }

            gsap.to(track, {
                x: getScrollAmount, 
                ease: "none",
                scrollTrigger: {
                    trigger: section2,
                    start: "top top",
                    end: () => "+=" + (image.offsetWidth * 7), 
                    pin: true, scrub: 1, invalidateOnRefresh: true, anticipatePin: 1,
                }
            });

            gsap.to(".h-giwa-layer", {
                xPercent: -12, ease: "none",
                scrollTrigger: { trigger: section2, start: "top top", end: () => "+=" + (image.offsetWidth * 7), scrub: 1 }
            });
            gsap.to(".h-step-layer", {
                xPercent: -10, ease: "none",
                scrollTrigger: { trigger: section2, start: "top top", end: () => "+=" + (image.offsetWidth * 7), scrub: 1 }
            });

            const entranceTl = gsap.timeline({
                scrollTrigger: {
                    trigger: section2,
                    start: "top top",
                    end: () => "+=" + window.innerWidth * 1.5, 
                    scrub: 1,
                }
            });

            entranceTl.from(".tree-img", { yPercent: 100, ease: "power2.out", duration: 1 }, 0)
                      .from(".hanok-img", { yPercent: -50, autoAlpha: 0, ease: "power2.out", duration: 1 }, 0)
                      .from(".woodpad-img", { yPercent: 200, autoAlpha: 0, stagger: 0.2, ease: "power2.out", duration: 1 }, 0)
                      .from(".palm-left", { xPercent: -100, ease: "power2.out", duration: 1 }, 0);

            gsap.from(".giwa-wrapper", { 
                yPercent: -200, 
                autoAlpha: 0, 
                stagger: 0.25, 
                ease: "power2.out", 
                duration: 1,
                scrollTrigger: {
                    trigger: section2,
                    start: () => "top top+=" + (image.offsetWidth * 0.15), 
                    end: () => "+=" + window.innerWidth,
                    scrub: 1,
                }
            });

            // 상시 애니메이션
            gsap.to(".giwa-img", {
                y: 6, duration: 3, ease: "sine.inOut", yoyo: true, repeat: -1, stagger: { each: 0.3, from: "start" }
            });
            gsap.fromTo(".grass-img", 
                { skewX: -3, scaleY: 1 }, { skewX: 3, scaleY: 0.98, duration: 3.5, repeat: -1, yoyo: true, ease: "sine.inOut", transformOrigin: "bottom center" }
            );
            gsap.fromTo(".tree-img", 
                { skewX: -1.5 }, { skewX: 1.5, duration: 5, repeat: -1, yoyo: true, ease: "sine.inOut", transformOrigin: "bottom center" }
            );
            gsap.to(".palm-img", { rotation: 1.5, scale: 1.02, duration: 2, ease: "sine.inOut", yoyo: true, repeat: -1 });
            gsap.to(".hanok-img", { y: 15, duration: 4, ease: "sine.inOut", yoyo: true, repeat: -1 });
            gsap.to(".woodpad-img", { y: 8, duration: 2.5, ease: "sine.inOut", yoyo: true, repeat: -1, stagger: { each: 0.3, from: "start" } });


            // ===================================================
            // [Section 3] 로직
            // ===================================================
            
            function getVerticalScrollAmount() {
                return vImage.offsetHeight - window.innerHeight;
            }

            // 1. 배경 수직 이동
            gsap.to(".v-bg-image, .v-objects", {
                y: getVerticalScrollAmount, 
                ease: "none",
                scrollTrigger: {
                    trigger: section3,
                    start: "top top", 
                    end: () => "+=" + (window.innerHeight * 15), 
                    pin: true, 
                    scrub: 1, 
                    invalidateOnRefresh: true,
                    anticipatePin: 1
                }
            });

            // 2. 블록 대각선 등장 (start: "top top")
            gsap.from(".block-1f, .block-2f", {
                xPercent: 100, 
                yPercent: 100, 
                autoAlpha: 0,
                duration: 1.5,
                stagger: 0.2, 
                ease: "power3.out", 
                scrollTrigger: {
                    trigger: section3,
                    start: "top top", 
                    toggleActions: "play none none reverse"
                }
            });

            // 3. 3층 블록 대각선 등장 (왼쪽)
            gsap.from(".block-3f", {
                xPercent: -100, 
                yPercent: 100, 
                autoAlpha: 0,
                duration: 1.5,
                delay: 0.3, 
                ease: "power3.out",
                scrollTrigger: {
                    trigger: section3,
                    start: "top top", 
                    toggleActions: "play none none reverse"
                }
            });

            // 4. 블록 부유 (층별 디테일 적용)
            
            // 1층: 무겁고 천천히
            gsap.to(".block-1f", {
                y: 10,
                duration: 4,
                ease: "sine.inOut",
                yoyo: true,
                repeat: -1
            });

            // 2층: 조금 더 활발하게 + 약간 회전
            gsap.to(".block-2f", {
                y: 15,
                rotation: 1,
                duration: 3.2,
                ease: "sine.inOut",
                yoyo: true,
                repeat: -1,
                delay: 0.5
            });

            // 3층: 가장 활발하게 + 반대 회전
            gsap.to(".block-3f", {
                y: 20,
                rotation: -1.5,
                duration: 2.8,
                ease: "sine.inOut",
                yoyo: true,
                repeat: -1,
                delay: 1
            });

        });
    </script>
</body>

</html>
